<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <meta charset="UTF-8" />
    <title>Dioxus-CLI Dev Server</title>
  </head>
  <body>
    <div id="main"></div>

    <!-- Note the usage of `type=module` here as this is an ES6 module -->
    <script type="module">
      import init from "./assets/module.js";
      init("./assets/module_bg.wasm");
    </script>

    <script>
      (function () {
        var protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
        var url = protocol + "//" + window.location.host + "/ws";
        var poll_interval = 2000;
        var reload_upon_connect = () => {
          window.setTimeout(() => {
            var ws = new WebSocket(url);
            ws.onopen = () => window.location.reload();
            ws.onclose = reload_upon_connect;
          }, poll_interval);
        };

        var ws = new WebSocket(url);
        ws.onmessage = (ev) => {
          if (ev.data == "reload") {
            window.location.reload();
          }
        };
        ws.onclose = reload_upon_connect;
      })();
    </script>
  </body>
</html>
